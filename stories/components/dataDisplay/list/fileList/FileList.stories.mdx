import { ArgsTable, Meta, Story, Canvas } from '@storybook/addon-docs/blocks';
import FileList from '@/components/list/fileList/FileList.vue';
import FileInput from '@/components/input/FileInput.vue';
import FileSummary from '@/components/list/fileList/FileSummary.vue';
import FileItem from '@/components/list/fileList/FileItem.vue';
import LinkItem from '@/components/list/fileList/LinkItem.vue';

<Meta
	title="Data Display/List/FileList"
	component={FileList}
	argTypes={{
		files: {
			description: '파일 리스트',
			defaultValue: [
				{
					file: { name: '1.png' },
					isLoading: false,
					isError: false,
				},
				{
					file: { name: '2.png' },
					isLoading: false,
					isError: false,
				},
				{
					file: { name: '3.png' },
					isLoading: false,
					isError: false,
				},
			],
		},
		links: {
			defaultValue: [
				{
					link: 'https://comento.kr',
				},
			],
		},
		isRemovable: {
			type: Boolean,
			control: {
				type: 'boolean',
			},
		},
	}}
/>

export const Default = (args, { argTypes }) => ({
	props: Object.keys(argTypes),
	data() {
		return {
			filesData: [...this.files, ...this.links],
		};
	},
	methods: {
		handleClickFileDownloadIcon(payload) {
			this.filesData[payload.index].isLoading = true;
			setInterval(() => {
				this.filesData[payload.index].isLoading = false;
			}, 3000);
		},
		handleClickFileItem(payload) {
			if (this.isRemovable) return this.handleClickFileTrashIcon(payload);
			this.filesData[payload.index].isLoading = true;
			setInterval(() => {
				this.filesData[payload.index].isLoading = false;
			}, 3000);
		},
		handleClickFileTrashIcon(payload) {
			this.filesData = this.filesData.filter((item, index) => index !== payload.index);
		},
		handleUploadFiles(files) {
			const filesWithLoading = Object.values(files).map(file => ({ file: file, isLoading: false }));
			this.filesData = [...this.filesData, ...filesWithLoading];
		},
	},
	template: `<div style="width: 100%; display: flex; align-items: flex-start; flex-direction: column;">
                <div :style="full ? 'width: 100%' : ''">
                 <FileInput v-if="isRemovable" @uploadFiles="handleUploadFiles"/>
                 <FileSummary v-else :full="full" :length="files.length" />
                 <FileList :full="full">
					<template v-for="(item, index) in filesData" :key="'file-' + index">
						<FileItem
							v-if="item.file"
							:file="item.file"
							:index="index"
							:is-removable="isRemovable"
							:is-loading="item.isLoading"
							:is-error="item.isError"
							@clickFileDownloadIcon="handleClickFileDownloadIcon"
							@clickFileItem="handleClickFileItem"
							@clickFileItemContent="handleClickFileItem"
							@clickFileTrashIcon="handleClickFileTrashIcon"
						/>
						<LinkItem
							v-if="item.link"
							:link="item.link"
							:index="index"
							:is-removable="isRemovable"
							@clickLinkItemContent="handleClickFileItem"
							@clickLinkTrashIcon="handleClickFileTrashIcon"
						/>
					</template>
				</FileList>
                </div>
             </div>`,
	components: { FileList, FileSummary, FileInput, FileItem, LinkItem },
});

# FileList

**FileList** 컴포넌트의 문서입니다.

<Story name="Default" height="100px">
	{Default.bind({})}
</Story>

<ArgsTable story="Default" />
